<!DOCTYPE html>
<html>
<head>
	<title>Prueba</title>
	<script src="https://cdn.socket.io/socket.io-1.4.5.js"></script>
	<script>
	  var socket = io('https://gentle-temple-29130.herokuapp.com');
	  

	socket.emit('getRides');
	function eliminar(){
		socket.emit('deleteRide', document.getElementById('id').value);
	}
	function joinear(){
		var id = document.getElementById('id').value;
		var email = document.getElementById('email').value;
		socket.emit('joinRide', {email: email, rideId: id});
	}
	function create(){
				socket.emit('createRide', {
		    "from": {
		        "province": 5,
		        "canton": "San Francisco"
		    },
		    "to": {
		        "province": "San Jose",
		        "canton": "San Jose"
		    },
		    "departureTime": "6:00 pm",
		    "seatsAvailable": 5,
		    "owner": "juanfe190@hotmail.com",
		});
	};

	function printRides(data){
		var div = document.getElementById("rides");
		div.innerHTML="";
		data.forEach(function(element, key){
			console.log(element);
			div.innerHTML = "<li>Ride id: "+element._id+"</li>";
			element.joinedUsers.forEach(function(user, key){
				div.innerHTML = div.innerHTML + "<li>JoinedUser: "+user.email+"</li>"
			});
		});
		
	}
	//**Listeners**//
	socket.on('err', function(data){console.error(data)});
	socket.on('updateClientRides', function(data){printRides(data)});
	</script>
</head>

<body>
<button onclick="create()">Crear ride</button><br><br>
ID: <input type="text" id="id"></input><br>
EMAIL: <input type="text" id="email">
<button onclick="eliminar()">Eliminar</button>
<button onclick="joinear()">Unirse</button><br><br>
<div>
	<ul id="rides"></ul>
</div>
</body>
</html>